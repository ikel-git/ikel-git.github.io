<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Terminal</title>
  <style>
    body {
      background: #000;
      color: #0f0;
      font-family: monospace;
      padding: 20px;
    }
    #terminal {
      white-space: pre-wrap;
      line-height: 1.4;
    }
    #cursor {
      display: inline-block;
      animation: blink 1s infinite;
    }
    @keyframes blink {
      0%, 50% { opacity: 1; }
      51%, 100% { opacity: 0; }
    }
  </style>
</head>
<body>
<div id="terminal"></div>

<script>
  let respostas = {};
  let linhas = [">"];          // histórico de linhas já fixadas (inclui prompts)
  let entradaAtual = "";        // texto sendo digitado na linha atual
  const terminal = document.getElementById("terminal");

  // Função para desenhar todo o terminal baseado no estado atual
  function renderizar() {
    // Junta as linhas do histórico com quebras de linha
    let conteudo = linhas.join("\n");
    // Adiciona o que está sendo digitado (sem quebra de linha extra)
    conteudo += entradaAtual;
    // Insere o cursor como elemento HTML (para piscar)
    terminal.innerHTML = conteudo + '<span id="cursor">|</span>';
    // Rola para o final automaticamente
    terminal.scrollTop = terminal.scrollHeight;
  }

  // Carrega o arquivo JSON
  fetch("respostas.json")
    .then(response => {
      if (!response.ok) {
        throw new Error("Erro ao carregar JSON: " + response.status);
      }
      return response.json();
    })
    .then(data => {
      respostas = data;
      // Mensagem opcional de sucesso
      linhas.push("> Arquivo de respostas carregado.");
      linhas.push(">");
      entradaAtual = "";
      renderizar();
    })
    .catch(error => {
      console.error(error);
      linhas.push("> ERRO: Não foi possível carregar respostas.json.");
      linhas.push(">");
      entradaAtual = "";
      renderizar();
    });

  // Renderização inicial (enquanto o JSON não carrega)
  renderizar();

  document.addEventListener("keydown", function (e) {
    // Previne ações padrão para as teclas que queremos controlar
    if (e.key === "Enter" || e.key === "Backspace" || e.key.length === 1) {
      e.preventDefault();
    }

    if (e.key === "Enter") {
      // Finaliza a linha atual: adiciona ao histórico
      linhas.push(entradaAtual);

      // Verifica se a entrada corresponde a alguma chave (ignora espaços extras)
      const chave = entradaAtual.trim();
      if (respostas.hasOwnProperty(chave)) {
        // Adiciona a resposta como uma nova linha (com prefixo > para destacar)
        linhas.push("> " + respostas[chave]);
      }
      // Se não houver resposta, apenas continua (não adiciona linha extra)

      // Adiciona novo prompt
      linhas.push(">");
      entradaAtual = "";
      renderizar();
      return;
    }

    if (e.key === "Backspace") {
      if (entradaAtual.length > 0) {
        entradaAtual = entradaAtual.slice(0, -1);
        renderizar();
      }
      return;
    }

    if (e.key.length === 1) {
      entradaAtual += e.key;
      renderizar();
    }
  });
</script>
</body>
</html>
