<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Terminal</title>
  <style>
    body {
      background: #000;
      color: #0f0;
      font-family: monospace;
      padding: 20px;
    }
    #terminal {
      white-space: pre-wrap;
      line-height: 1.4;
    }
    #cursor {
      display: inline-block;
      animation: blink 1s infinite;
    }
    @keyframes blink {
      0%, 50% { opacity: 1; }
      51%, 100% { opacity: 0; }
    }
  </style>
</head>
<body>
<div id="terminal"></div>

<script>
  let respostas = {};
  let linhas = [">"];          // histórico de linhas já fixadas (inclui prompts)
  let entradaAtual = "";        // texto sendo digitado na linha atual
  const terminal = document.getElementById("terminal");

  function renderizar() {
    let conteudo = linhas.join("\n");
    conteudo += entradaAtual;
    terminal.innerHTML = conteudo + '<span id="cursor">|</span>';
    terminal.scrollTop = terminal.scrollHeight;
  }

  // Carrega o arquivo JSON
  fetch("respostas.json")
    .then(response => {
      if (!response.ok) throw new Error("Erro ao carregar JSON: " + response.status);
      return response.json();
    })
    .then(data => {
      respostas = data;
      renderizar(); // apenas atualiza a tela, sem mensagens
    })
    .catch(error => {
      console.error(error);
      linhas.push("> ERRO: Não foi possível carregar respostas.json.");
      linhas.push(">");
      entradaAtual = "";
      renderizar();
    });

  renderizar(); // estado inicial

  document.addEventListener("keydown", function (e) {
    if (e.key === "Enter" || e.key === "Backspace" || e.key.length === 1) {
      e.preventDefault();
    }

    if (e.key === "Enter") {
      // 1. Concatena a entrada atual ao último prompt (última linha do histórico)
      if (linhas.length > 0) {
        linhas[linhas.length - 1] += entradaAtual;
      } else {
        linhas.push(entradaAtual); // fallback (improvável)
      }

      // 2. Verifica se a entrada corresponde a alguma chave
      const chave = entradaAtual.trim();
      if (respostas.hasOwnProperty(chave)) {
        linhas.push("> " + respostas[chave]);
      }

      // 3. Adiciona um novo prompt
      linhas.push(">");
      entradaAtual = "";
      renderizar();
      return;
    }

    if (e.key === "Backspace") {
      if (entradaAtual.length > 0) {
        entradaAtual = entradaAtual.slice(0, -1);
        renderizar();
      }
      return;
    }

    if (e.key.length === 1) {
      entradaAtual += e.key;
      renderizar();
    }
  });
</script>
</body>
</html>
